(()=>{"use strict";async function e(){await fetch("https://www.floatrates.com/daily/eur.json").then((e=>e.json())).then((e=>{chrome.storage.local.set({fiatCurrencies:e})}))}function t(e){chrome.runtime.sendMessage({message:"get_highlight"},(t=>{"success"===t.message&&e(t.payload)}))}function n(e,t){let n="",i="",r={},s=/^[0-9]+$/,c=!0;e=e.trim();for(let t=0;t<e.length;t++)s.test(e[0])?s.test(e[t])&&(i=i.concat("",e[t]),c=!1):c=!0,c?r={}:(n=e.slice(i.length,e.length).trim(),r={number:i,unit:n,conversionRate:0});r=function(e,t){let n,i={};!function(e,t){let n={isCurrency:!1,conversionRate:0,currency:e};!function(e){chrome.runtime.sendMessage({message:"get_fiat"},(t=>{"success"===t.message&&e(t.payload)}))}((i=>{n.isCurrency=e in i,n.isCurrency?(n.conversionRate=i[e].inverseRate,t(n)):t(n)}))}(e.unit,(r=>{switch(r.isCurrency&&(e.unit="currency"),e.unit){case"inch":n=2.54*e.number,i={number:n.toFixed(2),unit:"cm"};break;case"mile":case"miles":n=1.609344*e.number,i={number:n.toFixed(2),unit:"km"};break;case"F":n=(e.number-32)/1.8,i={number:n.toFixed(1),unit:"Â°C"};break;case"oz":n=28.34952*e.number,i={number:n.toFixed(1),unit:"g"};break;case"currency":n=e.number*r.conversionRate,i={number:n.toFixed(2),unit:"eur"};break;default:i={}}t(i)}))}(r,(e=>{t(e)}))}const i=document.createElement("DIV"),r=document.createElement("DIV"),s=(document.createElement("INPUT"),document.createElement("DIV")),c=document.createElement("DIV"),o=document.createElement("DIV");var a=document.createElement("link");a.setAttribute("rel","stylesheet"),a.setAttribute("type","text/css"),a.setAttribute("href","https://fonts.googleapis.com/css2?family=Lato:wght@300&display=swap"),document.head.appendChild(a);let u="",m=!1;function l(){document.querySelector("body").removeChild(i),m=!1}i.classList.add("ext-main"),r.id="ext-name",s.id="ext-btn",c.id="ext-btn",o.id="ext-unit",s.innerHTML="Search",c.innerHTML="Copy",i.appendChild(r),i.appendChild(c),i.appendChild(s),setTimeout((()=>{e()}),1e3),setInterval((()=>{e()}),288e5),document.addEventListener("mouseup",(e=>{!function(e){let t={x:e.pageX+"px",y:e.pageY+30+"px"};i.style.top=t.y,i.style.left=t.x;let r=window.getSelection().toString();r=r.trim(),0===r.length&&m&&l(),n(r,(e=>{r.length>0&&r!==u?(function(e){chrome.storage.local.set({highlight:e})}(r),m=!0,document.querySelector("body").appendChild(i)):(null!==document.getElementById("ext-name")&&r===u&&l(),m=!1),0!==Object.entries(e).length?(o.innerHTML=`${e.number} ${e.unit}`,i.appendChild(o)):null!==document.getElementById(o.id)&&0===Object.entries(e).length&&i.removeChild(o),u=r}))}(e)})),document.onkeydown=e=>{e.key&&m&&l()},c.addEventListener("mousedown",(()=>{t((e=>{navigator.clipboard.writeText(e).then((()=>{}))}))})),s.addEventListener("mousedown",(()=>{t((e=>{!function(e){chrome.runtime.sendMessage({message:"open_url",payload:e},(e=>{}))}(e),l()}))}))})();